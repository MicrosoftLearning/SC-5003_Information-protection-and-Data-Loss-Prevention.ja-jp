---
lab:
  task: Create a data loss prevention (DLP) policy
  exercise: Exercise 3 - Create a data loss prevention (DLP) policy
---

# スキル タスク

**タスク**:

1. シミュレーション モードで DLP ポリシーを作成する
1. DLP ポリシーを修正する
1. PowerShell で DLP ポリシーを作成する
1. シミュレーション モードでポリシーをアクティブ化する

## タスク 1: シミュレーション モードで DLP ポリシーを作成する

この演習では、データ損失防止 (DLP) ポリシーを作成し、ユーザーによる機密データの共有を防止します。 作成した DLP ポリシーを適用すると、クレジット カード情報を含むコンテンツを共有しようとするユーザーに通知を行い、ユーザーがこの情報を送信する正当な理由を提示できるようにします。 このブロック アクションがユーザーに影響を与えないよう、ポリシーはシミュレーション モードで実装します。

1. **Microsoft Edge** で、**`https://purview.microsoft.com`** に移動して、**コンプライアンス管理者**の権限を持つよう選択したユーザーとして Microsoft Purview ポータルにログインしてください。

1. 左側のサイド バーから **[ソリューション]** を選択し、**[データ損失防止]** を選択します。

1. 左サイドバーから、**[ポリシー]** を選択します。

1. **[ポリシー]** ページで **[+ ポリシーの作成]** を選択し、新しいデータ損失防止ポリシーを作成するための構成を開始します。

1. **[テンプレートの利用またはカスタム ポリシーの作成]** ページで、**[カスタム]** をカテゴリとして選択し、**[規制]** の下の **[カスタム ポリシー]** を選択します。

1. [**次へ**] を選択します。

1. **[DLP ポリシーの名前の設定]** ページで、以下を入力します。

   - **名前**: `Credit Card DLP Policy`
   - **説明**: `Protect credit card numbers from being shared`

1. [**次へ**] を選択します。

1. [**管理単位を割り当てる**] ページで、[**次へ**] を選択します。

1. **[ポリシーを適用する場所の選択]** ページで **[Teams チャットとチャネル メッセージ]** の場所のみを有効にします。 その他の場所が選択されている場合は、選択を解除します。

1. [**次へ**] を選択します。

1. **[ポリシー設定の定義]** ページで、**[詳細なDLPルールを作成またはカスタマイズします]** を選択し、**[次へ]** を選択します。

1. **[詳細な DLP ルールのカスタマイズ]** ページで、**[+ ルールを作成]** を選択します。

1. **[ルールの作成]** ポップアップ ページの **[名前]** フィールドに、名前として「`Credit card information`」を入力します。

1. **[条件]** で、**[+ 条件の追加]** を選択し、**[次を含むコンテンツ]** を選択します。

1. 新しい **[次を含むコンテンツ]** 領域で、**[追加]** を選択し、**[機密情報の種類]** を選択します。

1. **[機密情報の種類]** ページで **[クレジット カード番号]** を選択し、**[追加]** を選択します。

1. **[+ 条件の追加]** を選択し、**[Microsoft 365 からコンテンツを共有する]** を選択します。

1. **[Microsoft 365 からコンテンツを共有する]** セクションで、 **[組織内の連絡先のみ]** オプションを選択します。

1. **[アクション]** で、**[+ アクションの追加]** を選択し、**[Microsoft 365 の場所にあるコンテンツへのアクセスを制限またはコンテンツを暗号化する]** を選択します。

1. **[アクセスの制限または Microsoft 365 の場所にあるコンテンツの暗号化]** のボックスをチェックし、**[すべてのユーザーをブロックします]** を選択します。

1. **[ユーザーの通知]** で、**[ユーザーへのお知らせに通知を使い、機密情報の適切な使用についてのユーザーの教育に役立てる]** を **[オン]** にします。次に、**[Notify users in Office 365 service with a policy tip] (ポリシー ヒントを使用して Office 365 サービスでユーザーに通知する)** を選択します。

1. **[ユーザーによる上書き]** で、**[ファブリック (Power BIを含む), Exchange、Sharepoint、OneDrive、Teams でのユーザーによるポリシー制限の上書きを許可します]** のチェックボックスをオンにします。

1. **[上書きするには業務上の理由が必要です]** チェックボックスをオンにします。

1. **[インシデント レポート]** セクションの **[管理者のアラートとレポートでこの重大度レベルを使用する]** ドロップダウンで **[低]** を選択します。

1. **[ルールの作成]** の下部にある **[保存]** を選択します。

1. **[詳細な DLP ルールをカスタマイズする]** ページに戻り、**[次へ]** を選択します。

1. **[ポリシー モード]** ページで、**[シミュレーション モードでポリシーを実行する]** を選択し、**[シミュレーション モード中にポリシー ヒントを表示する]** を選択します。

1. [**次へ**] を選択します。

1. **[確認して完了]** ページで設定を確認し、**[送信]** を選択します

1. **[新しいポリシーが作成されました]** ページで、 **[完了]** を選択します。

これで、Microsoft Teams のチャットおよびチャンネルでクレジット カード番号をスキャンし、ポリシーをオーバーライドする業務上の正当な理由をユーザーが提供できるようにする DLP ポリシーが作成されました。

## タスク 2 : DLP ポリシーを修正する

このタスクでは、前のタスクで作成した既存の DLP ポリシーを変更して、電子メールでクレジット カード情報をスキャンします。 この変更により、より多くの通信チャネルで機密データが確実に保護されます。

1. Microsoft 365 で、引き続き**コンプライアンス管理者**に選択したユーザーとしてログインしている必要があります。

1. 引き続き Microsoft Purview の **[ポリシー]** ページにある必要があります。 **Microsoft Edge** を開き、`https://purview.microsoft.com` に移動します。 **[ソリューション]** > **[データ損失防止]** > **[ポリシー]** を選択します。

1. **[ポリシー]** ページで、先ほど作成した **[クレジット カードの DLP ポリシー]** のチェックボックスをオンにし、**[ポリシーの編集]** を選択してポリシー構成を開きます。

1. **[DLP ポリシーの名前の設定]** ページで **[次へ]** を選択します。

1. [**管理単位を割り当てる**] ページで、[**次へ**] を選択します。

1. **[ポリシーを適用する場所の選択]** ページで **[Exchange メール]** チェックボックスをオンにして、DLP ポリシーにこの場所を追加します。

1. **[確認と完了]** ページが表示されるまで、**[次へ]** を選択します。

1. **[確認と完了]** ページで **[送信]** を選択して、行った変更をポリシーに適用します。

1. ポリシーが更新されたら、**[ポリシーが更新されました]** ページで **[完了]** を選択します。

メール スキャンを含むように DLP ポリシーを正常に変更し、機密情報の保護を強化しました。

## タスク 3: PowerShell で DLP ポリシーを作成する

このタスクでは、PowerShell を使用して DLP ポリシーを作成し、Contoso の従業員 ID を保護して Exchange 経由で共有されるのを防ぎます。 このポリシーを適用すると、この機密データを共有しようとしているユーザーに通知が行われ、従業員 ID が含まれているメールがブロックされます。

1. デスクトップで、タスク バーの Windows ボタンを右クリックして、管理者特権の PowerShell ウィンドウを開き、**[Terminal (Admin)]** を選択します。

1. ターミナル ウィンドウで**モジュールのインストール** コマンドレットを実行して、最新の **Exchange Online PowerShell** モジュール バージョンをインストールします。

    ```powershell
    Install-Module ExchangeOnlineManagement
    ```

1. 信頼されていないレポジトリ セキュリティ ダイアログで、[はい] を示す **[Y]** を選択して確定し、**Enter** キーを押します。  この処理は、完了までに時間がかかる場合があります。

1. **Connect-IPPSSession** コマンドレットを実行して、Security & Compliance PowerShell に接続します。

   ```powershell
   Connect-IPPSSession
   ```

1. **[アカウントにサインイン]** ポップアップ ウィンドウで、**コンプライアンス管理者**に選択したユーザーとしてサインインします。

1. **New-DlpCompliancePolicy** コマンドレットを実行して、すべての Exchange メールボックスをスキャンする DLP ポリシーを作成します。

   ```powershell
   New-DlpCompliancePolicy -Name "EmployeeID DLP Policy" -Comment "This policy blocks sharing of Employee IDs" -ExchangeLocation All
   ```

1. **New-DlpComplianceRule** コマンドレットを実行して、前の手順で作成した DLP ポリシーに DLP ルールを追加します。

   ```powershell
   New-DlpComplianceRule -Name "EmployeeID DLP rule" -Policy "EmployeeID DLP Policy" -BlockAccess $true -ContentContainsSensitiveInformation @{Name="Contoso Employee IDs"}
   ```

1. **Get-DLPComplianceRule** コマンドレットを実行して、**EmployeeID DLP ルール**を確認します。

   ```powershell
   Get-DLPComplianceRule -Identity "EmployeeID DLP rule"
   ```

これで、PowerShell を使用して、Exchange で Contoso 従業員 ID をスキャンする DLP ポリシーを正常に作成しました。

## タスク 4: シミュレーション モードでポリシーをアクティブ化する

このタスクでは、シミュレーションモードで作成した**クレジット カード情報**の DLP ポリシーをアクティブ化し、保護アクションを強化します。

1. Microsoft 365 で、引き続き**コンプライアンス管理者**に選択したユーザーとしてログインしている必要があります。

1. **Microsoft Edge** で、`https://purview.microsoft.com` > **[ソリューション]** > **[データ損失防止]** に移動し、左側のサイドバーから **[ポリシー]** を選択して DLP ポリシーに移動します。

1. **[ポリシー]** ページで **[クレジット カードの DLP ポリシー]** のチェックボックスをオンにし、 **[ポリシーの編集]** を選択して [ポリシーの構成] を開きます。

1. **[ポリシー モード]** ページが表示されるまで **[次へ]** を選択し、**[すぐに有効にする]** を選択します。

1. **[確認して完了]** ページで、**[送信]** を選択します。

1. **[Policy updated] (ポリシーが更新されました)** ページで、 **[完了]** を選択します。

DLP ポリシーが正常にアクティブ化され、クレジット カード情報を共有しようとする試みがブロックされ、業務上の正当な理由が必要になります。
